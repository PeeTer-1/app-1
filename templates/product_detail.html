<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ product.name }} - ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <style>
        .product-img-placeholder {
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f8f9fa;
            color: #6c757d;
            font-size: 24px;
            border-radius: 8px;
        }
        
        .breadcrumb {
            display: flex;
            list-style: none;
            padding: 0;
            margin-bottom: 20px;
        }
        
        .breadcrumb-item {
            margin-right: 5px;
        }
        
        .breadcrumb-item::after {
            content: "/";
            margin-left: 5px;
        }
        
        .breadcrumb-item:last-child::after {
            content: "";
        }
        
        .breadcrumb-item.active {
            color: #6c757d;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table td {
            padding: 8px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .table td:first-child {
            font-weight: bold;
            width: 120px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <div class="logo">
                <a href="{{ url_for('home') }}">üõçÔ∏è ‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</a>
            </div>
            <button class="nav-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <nav>
                <ul>
                    <li><a href="{{ url_for('home') }}"><i class="fas fa-home"></i> ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a></li>
                    {% if session.get('user_id') %}
                        <li><a href="{{ url_for('add_product') }}"><i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
                        <li><a href="{{ url_for('my_products') }}"><i class="fas fa-box"></i> ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</a></li>
                        {% if not session.get('is_premium') %}
                            <li><a href="{{ url_for('upgrade_premium') }}"><i class="fas fa-star"></i> ‡∏≠‡∏±‡∏û‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°</a></li>
                        {% endif %}
                        <li><a href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt"></i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a></li>
                    {% else %}
                        <li><a href="{{ url_for('login') }}"><i class="fas fa-sign-in-alt"></i> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a></li>
                        <li><a href="{{ url_for('register') }}"><i class="fas fa-user-plus"></i> ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a></li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <nav aria-label="breadcrumb" class="mb-3">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ url_for('home') }}">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a></li>
                    {% if product.category %}
                    <li class="breadcrumb-item"><a href="{{ url_for('home', category=product.category) }}">{{ product.category }}</a></li>
                    {% endif %}
                    <li class="breadcrumb-item active" aria-current="page">{{ product.name }}</li>
                </ol>
            </nav>

            <div class="product-detail">
                <div class="product-detail-images">
                    {% if product.image %}
                        <img id="main-product-image" src="{{ url_for('static', filename='uploads/' + product.image) }}" alt="{{ product.name }}" class="product-detail-img">
                    {% else %}
                        <div class="product-img-placeholder">
                            <i class="fas fa-image fa-3x"></i>
                        </div>
                    {% endif %}
                    
                    {% if product.is_advertised %}
                    <div class="product-badge mt-2">
                        <span class="premium-badge"><i class="fas fa-star"></i> ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</span>
                    </div>
                    {% endif %}
                </div>

                <div class="product-detail-info">
                    <h1>{{ product.name }}</h1>
                    
                    <div class="product-detail-price">‡∏ø{{ "{:,.2f}".format(product.price) }}</div>
                    
                    <div class="product-detail-actions">
                        {% if session.get('user_id') and session.get('user_id') != product.seller_id %}
                            <a href="#" class="btn btn-secondary">
                                <i class="fas fa-shopping-cart"></i> ‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                            </a>
                            <a href="#" class="btn btn-primary add-to-cart" data-product-id="{{ product.id }}" data-product-name="{{ product.name }}">
                                <i class="fas fa-cart-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
                            </a>
                            <button class="btn btn-outline" onclick="toggleContactForm()">
                                <i class="fas fa-comment"></i> ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢
                            </button>
                        {% elif session.get('user_id') == product.seller_id %}
                            <a href="{{ url_for('edit_product', product_id=product.id) }}" class="btn btn-primary">
                                <i class="fas fa-edit"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                            </a>
                            <a href="{{ url_for('delete_product', product_id=product.id) }}" class="btn btn-danger" onclick="return confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ?')">
                                <i class="fas fa-trash"></i> ‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                            </a>
                            {% if not product.is_advertised and session.get('is_premium') %}
                            <a href="{{ url_for('advertise_product', product_id=product.id) }}" class="btn btn-accent">
                                <i class="fas fa-ad"></i> ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ
                            </a>
                            {% endif %}
                        {% else %}
                            <a href="{{ url_for('login') }}" class="btn btn-primary">
                                <i class="fas fa-sign-in-alt"></i> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                            </a>
                        {% endif %}
                    </div>

                    <div id="contact-form" class="card mt-3" style="display: none;">
                        <div class="card-body">
                            <h3><i class="fas fa-paper-plane"></i> ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢</h3>
                            <form id="seller-contact-form" onsubmit="return sendMessage(event)">
                                <div class="form-group">
                                    <label for="message" class="form-label">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°:</label>
                                    <textarea id="message" class="form-control" rows="4" required></textarea>
                                </div>
                                <div class="form-group">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane"></i> ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="product-detail-description mt-3">
                        <h3><i class="fas fa-info-circle"></i> ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                        <p>{{ product.description or "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" }}</p>
                    </div>
                    
                    <div class="product-detail-attributes mt-3">
                        <h3><i class="fas fa-list"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h3>
                        <table class="table">
                            <tbody>
                                {% if product.category %}
                                <tr>
                                    <td>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</td>
                                    <td>{{ product.category }}</td>
                                </tr>
                                {% endif %}
                                {% if product.condition %}
                                <tr>
                                    <td>‡∏™‡∏†‡∏≤‡∏û</td>
                                    <td>{{ product.condition }}</td>
                                </tr>
                                {% endif %}
                                <tr>
                                    <td>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</td>
                                    <td>{{ product.quantity|default('1', true) }} ‡∏ä‡∏¥‡πâ‡∏ô</td>
                                </tr>
                                <tr>
                                    <td>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏Ç‡∏≤‡∏¢</td>
                                    <td>{{ product.created_at.strftime('%d/%m/%Y') if product.created_at else '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="seller-info mt-3">
                        <h3><i class="fas fa-user"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢</h3>
                        <div class="d-flex align-center">
                            <div style="width: 40px; height: 40px; border-radius: 50%; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                                <i class="fas fa-user"></i>
                            </div>
                            <div>
                                <h4>{{ seller.username }}
                                    {% if seller.is_premium %}
                                    <span class="premium-badge"><i class="fas fa-star"></i> ‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°</span>
                                    {% endif %}
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {% if related_products %}
            <section class="related-products mt-4">
                <h2><i class="fas fa-tags"></i> ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</h2>
                <div class="product-grid">
                    {% for related in related_products %}
                    <div class="card product-card">
                        {% if related.image %}
                            <img src="{{ url_for('static', filename='uploads/' + related.image) }}" alt="{{ related.name }}" class="product-img">
                        {% else %}
                            <div class="product-img-placeholder" style="height: 200px; font-size: 16px;">
                                <i class="fas fa-image fa-2x"></i>
                            </div>
                        {% endif %}
                        <div class="product-info">
                            <h3 class="product-title">{{ related.name }}</h3>
                            <p class="product-price">‡∏ø{{ "{:,.2f}".format(related.price) }}</p>
                            <a href="{{ url_for('product_detail', product_id=related.id) }}" class="btn btn-primary btn-block mt-2">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h3>
                    <p>‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-line"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡πà‡∏ß‡∏ô</h3>
                    <ul>
                        <li><a href="{{ url_for('home') }}">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a></li>
                        <li><a href="{{ url_for('login') }}">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a></li>
                        <li><a href="{{ url_for('register') }}">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h3>
                    <ul>
                        <li><a href="{{ url_for('home', category='electronics') }}">‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå</a></li>
                        <li><a href="{{ url_for('home', category='fashion') }}">‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤</a></li>
                        <li><a href="{{ url_for('home', category='home') }}">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</a></li>
                        <li><a href="{{ url_for('home', category='others') }}">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h3>
                    <ul>
                        <li><a href="#">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢</a></li>
                        <li><a href="#">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</a></li>
                        <li><a href="#">‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a></li>
                        <li><a href="#">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                &copy; 2025 ‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå ‡∏™‡∏á‡∏ß‡∏ô‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>
        function toggleContactForm() {
            const contactForm = document.getElementById('contact-form');
            contactForm.style.display = contactForm.style.display === 'none' ? 'block' : 'none';
        }

        function sendMessage(event) {
            event.preventDefault();
            const message = document.getElementById('message').value;
            if (message.trim() === '') {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°');
                return false;
            }
            
            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢ (‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô backend)
            alert('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            document.getElementById('message').value = '';
            document.getElementById('contact-form').style.display = 'none';
            return false;
        }
    </script>
</body>
</html>